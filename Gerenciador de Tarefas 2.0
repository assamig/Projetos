#lista de tarefas que será usado no programa
tarefas = []


#with open cria acessa o arquivo, e garannte que ele se feche, com o w ele escreve no arquivo, e se o arquivo não existe, apaga e reescreve por cima
#enconding utf 8 permite caracteres tipo os emotes que vai ser utilizados
#"as arquivo" é a variavel do acesso e criação do arquivo
#no laço de repetição, ele percorre a lista e escreve cada tarefa um por um no arquivo
#\n serve para quebra de linha
def salvar_arquivo():
    with open("tarefa.txt", "w", encoding="utf-8") as arquivo:
        for tarefa in tarefas:
            arquivo.write(tarefa + "\n")


#aqui o principal vai ser integrar as linhas do arquivo txt na lista de tarefas
#acessando o arquivo ele vai ler com o "r", e com o laço de repetição
#pra cada linha no arquivo que ele ler, ele vai colocar na lista de tarefas,
#e com o strip tira espaços e caracteres indesejados, por exemplo o \n
#começa com o try para o programa não quebrar com um erro,
#e no except ele vai ignorar o erro com o pass caso o arquivo não seja encontrado e começe com o arquivo vazio
def carregar_arquivo():
    try:
        with open("tarefa.txt", "r", encoding="utf-8") as arquivo:
            for linha in arquivo:
                tarefas.append(linha.strip())
    except FileNotFoundError:
        pass

#adiciona tarefas com o append
#ele coloca o sinal do x para indicar que a tarefa ainda vai ser concluida
#O strip remove caracteres indesejados e espaços em branco
#ele chama o salvar o arquivo sempre que fizer alguma alteração
def adicionar():
    entrada = input("Adicione sua tarefa: ")
    tarefas.append(entrada.strip() + "❌")
    salvar_arquivo()
    print("Sua tarefa foi adicionada com sucesso!")

#pra cada indice e tarefa na lista de tarefas ele usa o ennumerate para mostrar o numero do indice da tarefa 
def indice():
    for i, tarefa in enumerate(tarefas):
        print("Índice: "
              f"{i} - {tarefa}")


#ele chama a função indice para mostrar o número do índice da tarefa na lista e remove pelo índice digitado usando pop
#o try expect retorna pra digitar um valor válido caso o indice não esteja na lista
#ele chama o salvar o arquivo sempre que fizer alguma alteração
def remover():
    try:
        indice()

        remove = int(input("Digite o índice da tarefa que deseja remover: "))
        tarefas.pop(remove)
        salvar_arquivo()
        print("Sua tarefa foi removida com sucesso!")
    except:
        "IndexError: pop index out of range"
        print("Digite um indice válido!")

#carrega as tarefas concluidas e não concluidas linha por linha usando a função "for"
#se a quantidade de caracteres na lista for igual aa 0, ele retorna que a lista está vazia
def carregar():
    for t in tarefas:
        print("Tarefa: ", t)

    if len(tarefas) == 0:
        print("Sua lista está vazia")

#ele verifica o indice na lista colocando o parametro do numero exato dele, indo de 0
#ate a quantidade de itens na lista, com o len
#se o sinal do x estiver no indice da lista das tarefas, ele vai substituir pelo sinal de certo 
#usando o replace
#se o indice digitado não estiver na lista, ele diz que o indice está inválido
#ele chama o salvar o arquivo sempre que fizer alguma alteração
def concluir():
    indice = int(input("Digite o índice da tarefa que deseja concluir: "))

    if 0 <= indice < len(tarefas):
        if "❌" in tarefas[indice]:
            tarefas[indice] = tarefas[indice].replace("❌","✔️")
            salvar_arquivo()

        print("Tarefa concluida com suceso!")
    else: 
        print("Indice inválido!")



#menu que mostra as opções disponiveis, e se o usuario escolher x opção, ele chama a função daquela opção
#se a opção não estiver nas opções disponiveis ou digitar qualquer outra coisa
#ele retorna pedindo pra escolher uma opção válida
def menu():
    while True:
        print("Bem vindo ao Gerenciador de Tarefas!")
        print("1. Adicionar tarefas")
        print("2. Remover tarefas")
        print("3. Carregar tarefas")
        print("4. Concluir tarefas")
        print("5. Sair")
        escolha = input("Digite sua opção: ")
        if escolha == "1":
            adicionar()
        elif escolha == "2":
            remover()
        elif escolha == "3":
            carregar()
        elif escolha == "4":
            concluir()
        elif escolha == "5":
            print("Saindo...")
            break
        else:
            print("Digite uma opção válida!")


#se o arquivo estiver rodando diretamente, ele chama a função do menu
#ele vai chamar o carregar arquivo primeiro pra carregar os arquivos antigos
if __name__ == "__main__":
    carregar_arquivo()
    menu()